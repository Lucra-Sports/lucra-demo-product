"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[804],{1886:(e,t,a)=>{a.d(t,{$5:()=>u,GT:()=>p,HW:()=>o,IA:()=>f,Nb:()=>h,Pu:()=>C,_G:()=>v,iD:()=>c,kW:()=>m,r7:()=>g,ri:()=>l,zN:()=>E});var n=a(4942);let r=a(1890).env.NEXT_PUBLIC_API_URL||"http://localhost:4000";async function s(e,t){try{let a=await fetch("".concat(r).concat(e),t),n=await a.json().catch(()=>({}));if(!a.ok)throw Error(n.error||"Request failed");return n}catch(e){if(e instanceof Error&&/(fetch|NetworkError|ECONNREFUSED)/i.test(e.message))throw Error("API server is unreachable");throw e}}function i(e){localStorage.setItem("rng_user",JSON.stringify(e))}function o(){let e=localStorage.getItem("rng_user");return e?JSON.parse(e):null}function d(){var e,t;return null!=(t=null==(e=o())?void 0:e.id)?t:null}function l(){localStorage.removeItem("rng_user");try{n.tg.logout(),console.log("!!!: RNG: Successfully logged out from Lucra SDK")}catch(e){console.warn("!!!: RNG: Lucra SDK not open or failed to logout:",e)}}async function c(e,t){let a=await s("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});return i(a),a}async function u(e){let t={id:(await s("/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:e.fullName,email:e.email,password:e.password,address:e.address,city:e.city,state:e.state,zipCode:e.zipCode,birthday:e.birthday})})).id,full_name:e.fullName,email:e.email,address:e.address,city:e.city,state:e.state,zip_code:e.zipCode,birthday:e.birthday};return i(t),t}async function h(){let e=d();return(await s("/rng",{headers:{"rng-user-id":e?String(e):""}})).number}async function p(){let e=d();return await s("/stats",{headers:{"rng-user-id":e?String(e):""}})}async function g(e){let t=d(),a=await s("/update-profile",{method:"POST",headers:{"Content-Type":"application/json","rng-user-id":t?String(t):""},body:JSON.stringify(e)});return i(a),a}async function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,a=d(),n=new URLSearchParams({page:String(e),limit:String(t)});return await s("/numbers?".concat(n.toString()),{headers:{"rng-user-id":a?String(a):""}})}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"oauth_provider",a=d();return await s("/bindings",{method:"PUT",headers:{"Content-Type":"application/json","rng-user-id":a?String(a):""},body:JSON.stringify({externalId:e,type:t})})}async function C(e){return console.log("!!!: RNG: lucraMatchupStarted - calling with:",{matchupId:e}),await s("/lucra/matchup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchupId:e})})}async function E(){let e=d();return await s("/bindings",{method:"GET",headers:{"rng-user-id":e?String(e):""}})}async function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"oauth_provider",t=d();return await s("/bindings/".concat(e),{method:"DELETE",headers:{"rng-user-id":t?String(t):""}})}},4942:(e,t,a)=>{function n(e){let t=new URLSearchParams;for(let[a,n]of Object.entries(e))a&&n&&t.set(a,n);return t}function r(e){console.log("Not implemented",e)}a.d(t,{bh:()=>C,PI:()=>f,tg:()=>g,QL:()=>p,TK:()=>E}),function(e){e.userInfo="userInfo",e.matchupCreated="matchupCreated",e.matchupStarted="matchupStarted",e.matchupCanceled="matchupCanceled",e.matchupAccepted="matchupAccepted",e.tournamentJoined="tournamentJoined",e.convertToCredit="convertToCredit",e.deepLink="deepLink",e.navigationEvent="navigationEvent",e.claimReward="claimReward"}(i||(i={})),function(e){e.clientUserInfo="clientUserInfo",e.convertToCreditResponse="convertToCreditResponse",e.enableConvertToCredit="enableConvertToCredit",e.deepLinkResponse="deepLinkResponse",e.navigate="navigate",e.availableRewards="availableRewards"}(o||(o={})),function(e){e.AGE_ASSURED_VERIFIED="AGE_ASSURED_VERIFIED",e.BLOCKED="BLOCKED",e.CLOSED="CLOSED",e.CLOSED_PENDING="CLOSED_PENDING",e.HIDDEN="HIDDEN",e.SUSPENDED="SUSPENDED",e.UNVERIFIED="UNVERIFIED",e.USER_SCAN_REQUIRED="USER_SCAN_REQUIRED",e.VERIFICATION_ERROR="VERIFICATION_ERROR",e.VERIFICATION_FAILED="VERIFICATION_FAILED",e.VERIFICATION_SCAN_PENDING="VERIFICATION_SCAN_PENDING",e.VERIFIED="VERIFIED"}(d||(d={}));class s{iframe;tenantId="";env="production";urlOrigin="";url="";useTestUsers=!1;messages=[];onMessage={userInfo:r,matchupCreated:r,matchupStarted:r,matchupCanceled:r,matchupAccepted:r,tournamentJoined:r,convertToCredit:r,deepLink:r,navigationEvent:r,claimReward:r};controller=new AbortController;iframeParentElement;iframeUrlOrigin(){return new URL(this.url).origin}_eventListener=e=>{if(e.origin===this.iframeUrlOrigin())switch(this.messages.push(e.data),e.data.type){case i.matchupCreated:this.onMessage.matchupCreated(e.data.data);break;case i.matchupStarted:this.onMessage.matchupStarted(e.data.data);break;case i.userInfo:this.onMessage.userInfo(e.data.data);break;case i.matchupCanceled:this.onMessage.matchupCanceled(e.data.data);break;case i.matchupAccepted:this.onMessage.matchupAccepted(e.data.data);break;case i.tournamentJoined:this.onMessage.tournamentJoined(e.data.data);break;case i.convertToCredit:this.onMessage.convertToCredit(e.data.data);break;case i.deepLink:this.onMessage.deepLink(e.data.data);break;case i.navigationEvent:this.onMessage.navigationEvent(e.data.data);break;case i.claimReward:this.onMessage.claimReward(e.data.data);break;default:console.log("Unrecognized LucraClientMessageType",e.data.type)}};setUpEventListener(){return window.addEventListener("message",this._eventListener,{signal:this.controller.signal}),null}constructor({tenantId:e,env:t,onMessage:a,useTestUsers:n}){this.env=t,this.tenantId=e,this.onMessage=a,this.urlOrigin="local"===this.env?"http://localhost:3000":`https://${this.tenantId.toLowerCase()}.${"production"!==this.env?`${this.env}.`:""}lucrasports.com`,this.useTestUsers=n||!1}set deepLinkHandler(e){this.onMessage.deepLink=e}set userInfoHandler(e){this.onMessage.userInfo=e}set matchupCreatedHandler(e){this.onMessage.matchupCreated=e}set matchupStartedHandler(e){this.onMessage.matchupStarted=e}set matchupAcceptedHandler(e){this.onMessage.matchupAccepted=e}set matchupCanceledHandler(e){this.onMessage.matchupCanceled=e}set tournamentJoinedHandler(e){this.onMessage.tournamentJoined=e}set navigationEventHandler(e){this.onMessage.navigationEvent=e}set convertToCreditHandler(e){this.onMessage.convertToCredit=e}set claimReward(e){this.onMessage.claimReward=e}_open({element:e,path:t="",params:a=new URLSearchParams,deepLinkUrl:n}){var r;let s=new URL(n||`${this.urlOrigin}/${t}?${a.toString()}`),i=(r=a.get("phoneNumber"))?/^[0-9]{10}$/.test(r)?r:void console.error("Phone number not valid, must be exactly 10 digits",r):void 0;i&&s.searchParams.set("loginHint",i),this.useTestUsers&&s.searchParams.set("connection","SDK-Test-Users"),s.searchParams.set("parentUrl",window.location.origin),this.url=s.toString(),this.setUpEventListener();try{this.iframeParentElement=e;let t=document.createElement("iframe");this.iframe=t,t.id="__lucrasports__",t.src=this.url,t.style.height="100%",t.style.width="100%",t.allow="geolocation *; web-share; accelerometer *; bluetooth *; gyroscope *; clipboard-write *; payment;",e.appendChild(t)}catch(e){console.error("Error opening up LucraSports",e)}finally{return this}}_redirect(e,t=new URLSearchParams,a){if(!this.iframe)throw Error("Cannot redirect. LucraSports is not open.");let n=new URL(a||`${this.urlOrigin}/${e}?${t.toString()}`);n.searchParams.set("parentUrl",window.location.origin),this.url=n.toString();try{this.sendMessage.navigate({pathname:`${n.pathname}${n.search}`})}catch(e){console.error("Error redirecting LucraSports",e)}finally{return this}}logout(){return this._redirect("logout")}redirect(){return{profile:()=>this._redirect("app/profile"),home:e=>{let t=new URLSearchParams;return void 0!==e&&t.set("locationId",e),this._redirect("app/home",t)},deposit:()=>this._redirect("app/add-funds"),withdraw:()=>this._redirect("app/withdraw-funds"),createMatchup:e=>{let t=new URLSearchParams;return void 0!==e&&t.set("hideNavigation","1"),this._redirect("app/create-matchup"+(void 0!==e?`/${e}/wager`:""),t)},matchupDetails:e=>this._redirect(`app/matchups/${e}`),tournamentDetails:e=>this._redirect(`app/tournaments/${e}`),deepLink:e=>{if(""===this.urlOrigin||0!==e.indexOf(this.urlOrigin))throw Error("Cannot open a url not associated with this tenant");return this._redirect("",void 0,e)}}}open(e,t){return{profile:()=>{let a=n({phoneNumber:t});return this._open({element:e,path:"app/profile",params:a})},home:a=>{let r=n({locationId:a,phoneNumber:t});return this._open({element:e,path:"app/home",params:r})},deposit:()=>{let a=n({phoneNumber:t});return this._open({element:e,path:"app/add-funds",params:a})},withdraw:()=>{let a=n({phoneNumber:t});return this._open({element:e,path:"app/withdraw-funds",params:a})},createMatchup:a=>{let r=n({hideNavigation:void 0!==a?"1":void 0,phoneNumber:t});return this._open({element:e,path:"app/create-matchup"+(void 0!==a?`/${a}/wager`:""),params:r})},matchupDetails:a=>{let r=n({phoneNumber:t});return this._open({element:e,path:`app/matchups/${a}`,params:r})},tournamentDetails:a=>{let r=n({phoneNumber:t});return this._open({element:e,path:`app/tournaments/${a}`,params:r})},deepLink:a=>{if(""===this.urlOrigin||0!==a.indexOf(this.urlOrigin))throw Error("Cannot open a url not associated with this tenant");return this._open({element:e,deepLinkUrl:a,params:n({phoneNumber:t})})}}}close(){this.controller.abort("Closing LucraClient"),this.iframeParentElement&&(this.iframeParentElement.innerHTML="")}_sendMessage(e){try{this.iframe?.contentWindow?.postMessage(e,this.iframeUrlOrigin())}catch(e){throw console.error("Unable to send message to LucraClient iframe",e),e}finally{return this}}sendMessage={userUpdated:e=>{this._sendMessage({type:o.clientUserInfo,body:e})},convertToCreditResponse:e=>{this._sendMessage({type:o.convertToCreditResponse,body:e})},enableConvertToCredit:()=>{this._sendMessage({type:o.enableConvertToCredit,body:null})},deepLinkResponse:e=>{this._sendMessage({type:o.deepLinkResponse,body:e})},navigate:e=>{this._sendMessage({type:o.navigate,body:e})},availableRewards:e=>{this._sendMessage({type:o.availableRewards,body:e})}}}var i,o,d,l=a(1886),c=a(1890);let u=null,h=null,p=e=>{u=e},g=new s({tenantId:"RNG",env:"sandbox",onMessage:{claimReward:e=>{console.log("!!!: SDK: Callback: Claim Reward",e)},convertToCredit:e=>{console.log("!!!: SDK: Callback: Convert To Credit",e)},deepLink:e=>{console.log("!!!: SDK: Callback: Deep Link",e)},matchupAccepted:e=>{console.log("!!!: SDK: Callback: Matchup Accepted",e)},matchupCanceled:e=>{console.log("!!!: SDK: Callback: Matchup Canceled",e)},matchupCreated:e=>{console.log("!!!: SDK: Callback: Matchup Created",e)},matchupStarted:e=>{console.log("!!!: SDK: Callback: Matchup Started",e),(0,l.Pu)(e.matchupId);let t=document.getElementById("lucra-iframe-container");t&&(t.classList.add("opacity-0","pointer-events-none"),t.classList.remove("opacity-100"),console.log("!!!: RNG: Hidden Lucra iframe after matchup started"))},navigationEvent:e=>{console.log("!!!: SDK: Callback: Navigation Event",e),u&&e.url&&u(e.url)},tournamentJoined:e=>{console.log("!!!: SDK: Callback: Tournament Joined",e)},userInfo:e=>{console.log("!!!: SDK: Callback: User Info",e),e.id&&(0,l.IA)(e.id).then(()=>{console.log("RNG: Successfully updated bindings for Lucra user:",e.id)}).catch(e=>{console.error("RNG: Failed to update bindings:",e)})}}});g.deepLinkHandler=function(e){let{url:t}=e;console.log("!!!: RNG: handleDeepLinkRequest: Lucra URL: ",t),h=t;let a="http://localhost:3000?redirect=".concat(h);console.log("!!!: RNG: Custom deep link URL: ",a),null==g||g.sendMessage.deepLinkResponse({url:a})};let m=null,f=e=>{let t=document.getElementById("lucra-iframe-container");t&&(m=g.open(t,e))},C=()=>{if(!m){let e=document.getElementById("lucra-iframe-container");e&&(m=g.open(e))}let e=document.getElementById("lucra-iframe-container");return e&&m&&(e.classList.remove("opacity-0","pointer-events-none"),e.classList.add("opacity-100")),m},E=e=>{let t={};e.full_name&&(t.username=e.full_name),e.avatar_url&&(t.avatarURL=e.avatar_url),e.phone_number&&(t.phoneNumber=e.phone_number),e.email&&(t.email=e.email),e.fullName&&(t.firstName=e.fullName.split(" ")[0],t.lastName=e.fullName.split(" ")[1]),(e.address||e.city||e.state||e.zip_code)&&(t.address={},e.address&&(t.address.address=e.address),e.city&&(t.address.city=e.city),e.state&&(t.address.state=e.state),e.zip_code&&(t.address.zip=e.zip_code)),c.env.NEXT_PUBLIC_MOCK_PHONE_NUMBER&&(t.phoneNumber=c.env.NEXT_PUBLIC_MOCK_PHONE_NUMBER),console.log("!!!: RNG via LucraClient: sendMessage.userUpdated: ",t),g.sendMessage.userUpdated(t)}}}]);